"use strict";function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}document.documentElement.classList.remove("no-js");var THEME_STORAGE_KEY="theme",ThemeSwitcher=function(){function e(){_classCallCheck(this,e),this.activeTheme="default",this.hasLocalStorage="undefined"!=typeof Storage,this.svg=document.getElementById("photo__themes"),this.toggle=document.getElementById("theme-switcher__display"),this.themeSwitcher=document.querySelector(".theme-switcher"),this.themeOptionsContainer=document.querySelector(".theme-switcher__options"),this.themeOptions=document.querySelectorAll(".theme-switcher__option"),this.init()}return _createClass(e,[{key:"init",value:function(){var e=this.getSystemPreference(),t=this.getStoredPreference();t?this.activeTheme=t:e&&(this.activeTheme=e),this.bindEvents(),this.setTheme(this.activeTheme),document.documentElement.setAttribute("data-switcher-open",!1),this.themeOptionsContainer.setAttribute("hidden",!0)}},{key:"bindEvents",value:function(){var r=this;this.toggle.addEventListener("click",function(){return r.toggleOptionDisplay()}),this.themeOptions.forEach(function(e){var t=e.dataset.theme;t&&e.addEventListener("click",function(){return r.setTheme(t)})}),this.handleThemeMenu=this.handleThemeMenu.bind(this),this.forceCloseThemeMenu=this.forceCloseThemeMenu.bind(this),new MutationObserver(this.handleThemeMenu).observe(this.toggle,{attributes:!0,attributeFilter:["aria-expanded"]}),this.tabTrapThemeMenu=this.tabTrapThemeMenu.bind(this)}},{key:"handleThemeMenu",value:function(e){var t=_createForOfIteratorHelper(e);try{for(t.s();!(r=t.n()).done;){var r=r.value;"aria-expanded"===r.attributeName&&("true"===r.target.attributes.getNamedItem("aria-expanded").nodeValue?(document.documentElement.setAttribute("data-switcher-open",!0),this.themeOptionsContainer.removeAttribute("hidden"),this.themeSwitcher.addEventListener("keydown",this.tabTrapThemeMenu),document.addEventListener("keydown",this.forceCloseThemeMenu),document.addEventListener("click",this.forceCloseThemeMenu)):(document.documentElement.setAttribute("data-switcher-open",!1),this.themeOptionsContainer.setAttribute("hidden",!0),this.themeSwitcher.removeEventListener("keydown",this.tabTrapThemeMenu),document.removeEventListener("keydown",this.forceCloseThemeMenu),document.removeEventListener("click",this.forceCloseThemeMenu)))}}catch(e){t.e(e)}finally{t.f()}}},{key:"getSystemPreference",value:function(){return!!window.matchMedia("(prefers-color-scheme: dark)").matches&&"dark"}},{key:"getStoredPreference",value:function(){return!!this.hasLocalStorage&&localStorage.getItem(THEME_STORAGE_KEY)}},{key:"toggleOptionDisplay",value:function(){if((0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).forceClose)return this.toggle.setAttribute("aria-expanded",!1),this.toggle.focus();var e="false"!==this.toggle.getAttribute("aria-expanded");return this.toggle.setAttribute("aria-expanded",String(!e))}},{key:"tabTrapThemeMenu",value:function(e){var t=this.toggle,r=this.themeOptions.item(this.themeOptions.length-1);return e.target===t&&e.shiftKey&&"Tab"===e.key?(e.preventDefault(),r.focus()):e.target!==r||e.shiftKey||"Tab"!==e.key?void 0:(e.preventDefault(),t.focus())}},{key:"forceCloseThemeMenu",value:function(e){if("keydown"===e.type&&"Escape"===e.key)return this.toggleOptionDisplay({forceClose:!0});if("click"===e.type){e=e.composedPath&&e.composedPath();if(e&&!e.includes(this.themeSwitcher))return this.toggleOptionDisplay({forceClose:!0})}}},{key:"setTheme",value:function(t){this.activeTheme=t,document.documentElement.setAttribute("data-theme",t),this.themeOptions.forEach(function(e){e.dataset.theme!==t?e.removeAttribute("aria-checked"):e.setAttribute("aria-checked","true")}),this.hasLocalStorage&&localStorage.setItem(THEME_STORAGE_KEY,t)}}]),e}();window.CSS&&CSS.supports("color","var(--fake-var)")&&new ThemeSwitcher;